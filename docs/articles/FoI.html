<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Force of Infection (FoI) • ramp.falciparum</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The Force of Infection (FoI)">
<meta property="og:description" content="ramp.falciparum">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ramp.falciparum</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/FoI.html">FoI</a>
    </li>
    <li>
      <a href="../articles/Dynamics.html">Infection Dynamics</a>
    </li>
    <li>
      <a href="../articles/MoI.html">MoI</a>
    </li>
    <li>
      <a href="../articles/Hybrid.html">Hybrid</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dd-harp/ramp.falciparum/" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The Force of Infection (FoI)</h1>
            <h3 data-toc-skip class="subtitle">Building Trace
Functions</h3>
            
      
      
      <div class="hidden name"><code>FoI.Rmd</code></div>

    </div>

    
    
<p>We want to be able to simulate arbitrary patterns of exposure in
cohorts as they age, with the ability to compare two cohorts of
different ages in the same population. We let <span class="math inline">\(h(t)\)</span> denote the average daily FoI in a
population, the hazard rate for infection. Notably, knowing the birth
day for a cohort, <span class="math inline">\(\tau,\)</span> we can
convert between age and time using the identity <span class="math display">\[t = a + \tau.\]</span> We let <span class="math inline">\(\omega(a)\)</span> be a function that computes a
<em>frailty</em> term associated with age, so we can write the FoI for
any cohort as: <span class="math display">\[h_\tau(a) = \omega(a) h(a)
=  \omega(a) h(t-\tau).\]</span></p>
<p>We begin by constructing functions, <span class="math inline">\(h(t),\)</span> to pressure test our models. We
assume exposure has a seasonal pattern, <span class="math inline">\(S(t)\)</span>, and a temporal trend, <span class="math inline">\(T(t)\)</span>, and <span class="math display">\[h(t) = \bar h \cdot S(t) \cdot T(t).\]</span></p>
<p>Motivated by the evidence for age-dependent exposure, the rate of
exposure in a cohort is assumed to change with age. We use the
age-weighting function, <span class="math inline">\(\omega(a)\)</span>,
consistent with the available evidence from both anopheline and aedine
mosquitoes (Port GR, <em>et al.</em>, 1980;<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, Carnevale P, <em>et
al.</em>, 1978;<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>, Liebman KA, <em>et al.</em>, 2014<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>) . Each
cohort is indexed by its birth day, <span class="math inline">\(\tau\)</span>. The FoI at age <span class="math inline">\(a\)</span> for the cohort born on day <span class="math inline">\(\tau\)</span>, which is at time <span class="math inline">\(t=a+\tau\)</span>, is defined for <span class="math inline">\(a&gt;0\)</span>:</p>
<p><span class="math display">\[\begin{equation}
h_\tau(a) = \bar h \cdot \omega(a) \cdot S(a+\tau) \cdot T(a+\tau)
\end{equation}\]</span></p>
<p>We can thus compare exposure and infection for cohorts of different
ages, of the same age at different times. We let <span class="math inline">\(H_\tau(a)\)</span> denote the size of the cohort
of age <span class="math inline">\(a\)</span> born on day <span class="math inline">\(\tau\)</span>, and we note that for <span class="math inline">\(h(t)\)</span> to be the <em>average</em> FoI for
the population, it must be true that <span class="math display">\[h(t) =
\int_{-\infty}^t h_\tau(a) H_\tau(a) d \tau \]</span> In most of our
simulations, we compute quantities for single cohorts as they age, and
we choose functions <span class="math inline">\(\omega(a)\)</span>
without worrying about this constraint. When we deal with the whole
human population, however, we must enforce the constraint.</p>
<p>The <code>FoI</code> is defined as an <strong>S3</strong> class
function that returns the FoI at ages <code>a</code> for a cohort with
birthdate <code>tau</code>, for a function defined by <code>par</code>.
The optional passed parameter <code>hhat</code> overrides the value of
<code>hbar</code> set in <code>par</code> when it is not
<code>null</code>:</p>
<ul>
<li><p><span class="math inline">\(\bar h\)</span> or <code>hbar</code>
sets the overall level of exposure</p></li>
<li><p><span class="math inline">\(S(t)\)</span> or
<code>seasonalFoI</code> defines a seasonal pattern</p></li>
<li><p><span class="math inline">\(T(t)\)</span> or
<code>trendFoI</code> defines a temporal trend</p></li>
<li><p><span class="math inline">\(\omega(a)\)</span> or
<code>ageFoI</code> defines a change in exposure with respect to age
relative to the mean population FoI</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plotFoI</span><span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">h</span>, <span class="va">FoIpar</span>, <span class="va">tau</span><span class="op">=</span><span class="fl">0</span>, <span class="va">Tmax</span><span class="op">=</span><span class="fl">5</span><span class="op">*</span><span class="fl">365</span>, <span class="va">clrs</span><span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">L</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">h</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">clrs</span><span class="op">)</span><span class="op">)</span> <span class="va">clrs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="va">L</span><span class="op">)</span></span>
<span>  <span class="va">tms</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">Tmax</span></span>
<span>  <span class="va">tm</span> <span class="op">=</span> <span class="va">tms</span><span class="op">/</span><span class="fl">365</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tm</span>, <span class="fl">365</span><span class="op">*</span><span class="va">h</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="../reference/FoI.html">FoI</a></span><span class="op">(</span><span class="va">tms</span>, <span class="va">FoIpar</span>, <span class="va">tau</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span>, </span>
<span>       xlab <span class="op">=</span> <span class="st">"Host Age (Years)"</span>, ylab <span class="op">=</span> <span class="st">"aFoI"</span><span class="op">)</span> </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">L</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">tm</span>, <span class="fl">365</span><span class="op">*</span><span class="va">h</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="../reference/FoI.html">FoI</a></span><span class="op">(</span><span class="va">tms</span>,<span class="va">FoIpar</span>, <span class="va">tau</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clrs8b</span> <span class="op">&lt;-</span> <span class="fu">viridisLite</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">inferno</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">FoIfigure</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">hh</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">.5</span>, <span class="fl">.2</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">/</span><span class="fl">365</span>, </span>
<span>                     <span class="va">tau</span><span class="op">=</span><span class="fl">0</span>, <span class="va">clrs</span> <span class="op">=</span> <span class="va">clrs8b</span>, <span class="va">Tmax</span><span class="op">=</span><span class="fl">5</span><span class="op">*</span><span class="fl">365</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">plotFoI</span><span class="op">(</span><span class="va">hh</span>, <span class="va">foiP4</span>, <span class="va">tau</span>, <span class="va">Tmax</span>, <span class="va">clrs</span><span class="op">)</span> </span>
<span>  <span class="fu">plotFoI</span><span class="op">(</span><span class="va">hh</span>, <span class="va">foiP3</span>, <span class="va">tau</span>, <span class="va">Tmax</span>, <span class="va">clrs</span><span class="op">)</span> </span>
<span><span class="op">}</span> </span></code></pre></div>
<p><img src="FoI_files/figure-html/FoIFigure-1.png" width="576"></p>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>G. R. Port, P. F. L. Boreham, J. H. Bryan, The
relationship of host size to feeding by mosquitoes of the Anopheles
Gambiae Giles complex (Diptera: Culicidae). Bulletin of Entomological
Research 70, 133–144 (1980).<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>P. Carnevale, J. L. Frézil, M. F. Bosseno, F. Le Pont,
J. Lancien, [The aggressiveness of Anopheles gambiae A in relation to
the age and sex of the human subjects]. Bull. World Health Organ. 56,
147–154 (1978).<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>K. A. Liebman, et al., Determinants of Heterogeneous
Blood Feeding Patterns by Aedes Aegypti in Iquitos, Peru. PLoS Negl.
Trop. Dis. 8, e2702 (2014).<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by John M. Henry, David L. Smith.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
