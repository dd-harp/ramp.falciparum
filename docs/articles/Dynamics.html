<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Random Variables for Parasite Infection Dynamics • ramp.falciparum</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Random Variables for Parasite Infection Dynamics">
<meta property="og:description" content="ramp.falciparum">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ramp.falciparum</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/FoI.html">FoI</a>
    </li>
    <li>
      <a href="../articles/Dynamics.html">Infection Dynamics</a>
    </li>
    <li>
      <a href="../articles/MoI.html">MoI</a>
    </li>
    <li>
      <a href="../articles/Hybrid.html">Hybrid</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dd-harp/ramp.falciparum/" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Random Variables for Parasite Infection
Dynamics</h1>
            <h3 data-toc-skip class="subtitle">Computing the MoI, AoI,
and AoY</h3>
            
      
      
      <div class="hidden name"><code>Dynamics.Rmd</code></div>

    </div>

    
    
<p>We have derived mathematical formulas that describe the dynamics of
malaria infections as random variables in cohorts of humans as they age
(Henry JM, <em>et al.</em>, 2024)<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> This R package is the computational
companion.</p>
<p>In the following, we review the mathematical formulas and the
functions in <code>ramp.falciparum</code> that compute the multiplicity
of infection (MoI), the age of infection (AoI), and the age of the
youngest infection (AoY).</p>
<div class="section level2">
<h2 id="formulas-and-computation">Formulas and Computation<a class="anchor" aria-label="anchor" href="#formulas-and-computation"></a>
</h2>
<ol style="list-style-type: decimal">
<li>
<p>Let <span class="math inline">\(z_\tau(\alpha,a)\)</span> denote
the density for infections of age <span class="math inline">\(\alpha\)</span> in a host cohort of age <span class="math inline">\(a\)</span> born on day <span class="math inline">\(\tau\)</span>.</p>
<ul>
<li><p>The dynamics of <span class="math inline">\(z(\alpha,a)\)</span>
are described by the following: <span class="math display">\[
\frac{\partial z}{\partial a} + \frac{\partial z}{\partial \alpha} = - r
z
\]</span> with the boundary condition: <span class="math display">\[
\begin{equation}
z_\tau(0,a) = h_\tau(a).
\end{equation}
\]</span> Its solutions are given by: <span class="math display">\[
z_\tau(\alpha,a) = h_\tau(a-\alpha) e^{-r \alpha}
\]</span></p></li>
<li><p>The function <code>zda</code> computes <span class="math inline">\(z_\tau(\alpha, a).\)</span></p></li>
</ul>
</li>
<li>
<p>The mean MoI is given by the formula: <span class="math display">\[
m_\tau(a) = \int_0^a z_\tau(\alpha, a) d \alpha
\]</span></p>
<ul>
<li><p>The distribution of the MoI is Poisson (Nåsell I, 1985)<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> with mean
<span class="math inline">\(m_\tau(a).\)</span></p></li>
<li><p>The function <code>meanMoI</code> computes <span class="math inline">\(m_\tau(a)\)</span> using <code>zda</code></p></li>
</ul>
</li>
<li><p>The true prevalence is the <span class="math display">\[
p_\tau(a) = 1 - e^{-m_\tau(a)}
\]</span> The function <code>truePR</code> computes the true prevalence
using <code>meanMoI</code></p></li>
<li><p>The density function for the age of infection (AoI) is <span class="math display">\[
A_\tau(a) \sim f_A(\alpha, a, \tau) = \frac{z_\tau(\alpha,a)}{m_\tau(a)}
\]</span> and its moments are <span class="math display">\[
x_n(a, \tau | h) = \int_0^a  \alpha^n f_A(\alpha, a, \tau) d \alpha
\]</span></p></li>
<li>
<p>The age of the youngest infection (AoY) is defined as: <span class="math display">\[
Y_\tau(a) \sim f_Y(\alpha, a, \tau) = \min_{\zeta \sim M_\tau(a)}
\left\{ \alpha_i \right\}_{i=1}^\zeta,  \alpha_i \sim A_\tau(a)
\]</span></p>
<ul>
<li><p>The density function can be expressed in terms of the density and
distribution functions of the AoI and MoI. <span class="math display">\[
f_Y(\alpha; a, \tau) =
f_A(\alpha, a,\tau) e^{-m_\tau(a) F_A(\alpha, a,\tau)}
\frac{m_\tau(a)}{p_\tau(a)}.
\]</span></p></li>
<li><p>The distribution function for the AoY is: <span class="math display">\[
F_Y(a) \sim
\frac{1-e^{-m_\tau(a)F_A(\alpha, a,\tau)}}{1-e^{-m_\tau(a)}} =
\frac{1-e^{-m_\tau(a)F_A(\alpha, a,\tau)}}{p_\tau(a)}
\label{FY}
\]</span></p></li>
<li><p>Its moments are: <span class="math display">\[
y_n(a, \tau | h) = \int_0^a  \alpha^n f_Y(\alpha | a, \tau, h) d \alpha
\]</span></p></li>
</ul>
</li>
<li>
<p>We also developed functions to compute the age of the youngest of
<span class="math inline">\(N\)</span> infections, called YoN <span class="math display">\[
N_\tau(a) \sim
\min_{N} \left\{ \alpha_i \right\}_{i=1}^N \mbox { where }  \alpha_i
\sim A_\tau(a)
\]</span></p>
<ul>
<li><p>The distribution function for YoN, <span class="math inline">\(N_\tau(a)\)</span>, is <span class="math display">\[F_N(\alpha, a, t) \sim 1- (1-F_A(\alpha, a,
\tau))^N\]</span> The following is a summary table of functions to
compute the MoI, AoI, AoY, and all their moments.</p></li>
<li><p>The density function for YoN is found by
differentiating:</p></li>
</ul>
</li>
</ol>
<p><span class="math display">\[f_N(\alpha, a, t) \sim N (1-F_A(\alpha,
a, \tau))^{N-1}\frac{f_A(\alpha, a, \tau)}{m_\tau(a)}\]</span></p>
</div>
<div class="section level2">
<h2 id="quick-reference">Quick Reference<a class="anchor" aria-label="anchor" href="#quick-reference"></a>
</h2>
<p>The following is a summary table of functions to compute the MoI,
AoI, AoY, YoN, and all their moments.</p>
<center>
<table class="table">
<colgroup>
<col width="23%">
<col width="19%">
<col width="19%">
<col width="19%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th></th>
<th align="center">MoI</th>
<th align="center">AoI</th>
<th align="center">AoY</th>
<th align="center">YoN</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code></code></td>
<td align="center"><span class="math inline">\(\zeta\)</span></td>
<td align="center"><span class="math inline">\(\alpha\)</span></td>
<td align="center"><span class="math inline">\(\alpha\)</span></td>
<td align="center"><span class="math inline">\(\alpha\)</span></td>
</tr>
<tr class="even">
<td><code></code></td>
<td align="center"><span class="math inline">\(\zeta \geq
0\)</span></td>
<td align="center"><span class="math inline">\(0 \leq \alpha \leq
a\)</span></td>
<td align="center"><span class="math inline">\(0 \leq \alpha \leq
a\)</span></td>
<td align="center"><span class="math inline">\(0 \leq \alpha \leq
a\)</span></td>
</tr>
<tr class="odd">
<td>Random Variable</td>
<td align="center"><span class="math inline">\(M_\tau(\zeta, a,
h)\)</span></td>
<td align="center"><span class="math inline">\(A_\tau(\alpha, a,
h)\)</span></td>
<td align="center"><span class="math inline">\(Y_\tau(\alpha, a ,
h)\)</span></td>
<td align="center"><span class="math inline">\(N_\tau(\alpha, a,
h)\)</span></td>
</tr>
<tr class="even">
<td>Density Function</td>
<td align="center"><span class="math inline">\(f_M(\zeta, a,
h)\)</span></td>
<td align="center"><span class="math inline">\(f_A(\zeta, a,
h)\)</span></td>
<td align="center"><span class="math inline">\(f_Y(\zeta, a,
h)\)</span></td>
<td align="center"><span class="math inline">\(f_N(\zeta, a,
h)\)</span></td>
</tr>
<tr class="odd">
<td><code></code></td>
<td align="center">dpois</td>
<td align="center">dAoI</td>
<td align="center">dAoY</td>
<td align="center">dYoN</td>
</tr>
<tr class="even">
<td>Distribution Function</td>
<td align="center"><span class="math inline">\(F_M(\zeta, a,
h)\)</span></td>
<td align="center"><span class="math inline">\(F_A(\zeta, a,
h)\)</span></td>
<td align="center"><span class="math inline">\(F_Y(\zeta, a,
h)\)</span></td>
<td align="center"><span class="math inline">\(F_N(\zeta, a,
h)\)</span></td>
</tr>
<tr class="odd">
<td><code></code></td>
<td align="center">ppois</td>
<td align="center">pAoI</td>
<td align="center">pAoY</td>
<td align="center">pYoN</td>
</tr>
<tr class="even">
<td>Random Numbers</td>
<td align="center"><span class="math inline">\(\hat M_\tau(\zeta, a,
h)\)</span></td>
<td align="center"><span class="math inline">\(\hat A_\tau(\alpha, a,
h)\)</span></td>
<td align="center"><span class="math inline">\(\hat Y_\tau(\alpha, a ,
h)\)</span></td>
<td align="center"><span class="math inline">\(\hat N_\tau(\alpha, a ,
h)\)</span></td>
</tr>
<tr class="odd">
<td><code></code></td>
<td align="center">rpois</td>
<td align="center">rAoI</td>
<td align="center">rAoY</td>
<td align="center">rYoN</td>
</tr>
<tr class="even">
<td>Moments</td>
<td align="center"><span class="math inline">\(m_\tau(a,
h)\)</span></td>
<td align="center"><span class="math inline">\(x_n(a, \tau,
h)\)</span></td>
<td align="center"><span class="math inline">\(y_n(a, \tau,
h)\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td><code></code></td>
<td align="center">meanMoI</td>
<td align="center">momentAoI</td>
<td align="center">momentAoY</td>
<td align="center"></td>
</tr>
</tbody>
</table>
</center>
</div>
<div class="section level2">
<h2 id="demonstration">Demonstration<a class="anchor" aria-label="anchor" href="#demonstration"></a>
</h2>
<div class="section level3">
<h3 id="force-of-infection-foi">Force of Infection (FoI)<a class="anchor" aria-label="anchor" href="#force-of-infection-foi"></a>
</h3>
<p>To compute anything, we must first set up a function to describe
exposure (see the <a href="FoI.html">FoI</a> vignette). We define
functions that plot the FoI for a cohort as it ages (in red), but we can
also compute the population average FoI (in black). Different cohorts
would experience different histories of exposure.</p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="computing-zda">Computing <code>zda</code><a class="anchor" aria-label="anchor" href="#computing-zda"></a>
</h3>
<p>The function <code>ramp.falciparum::zda(alpha, a, FoIpar, ...)</code>
uses the formula in Eq. 1 to compute the density of parasite infections
in a cohort of humans as it ages.</p>
<p>Using <code>zda,</code> we can compute the density of parasites in a
cohort of any age without solving a full system of equations. Given a
function describing the FoI in the population, <span class="math inline">\(h(t)\)</span>, and the cohort birthday, <span class="math inline">\(\tau.\)</span></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">=</span> <span class="fl">60</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fl">6</span><span class="op">*</span><span class="fl">365</span></span>
<span><span class="fu"><a href="../reference/zda.html">zda</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">6</span><span class="op">*</span><span class="fl">365</span>, <span class="va">foiP3</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.001601196</span></span></code></pre>
<p>The following computes the density of infections of every age in a
cohort of age 3.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zz</span> <span class="op">=</span> <span class="fu"><a href="../reference/zda.html">zda</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">a3years</span><span class="op">)</span>, <span class="va">foiP3</span><span class="op">)</span></span></code></pre></div>
<p>When we plot <span class="math inline">\(z_\tau(\alpha, a)\)</span>,
we note that as <span class="math inline">\(\alpha\)</span> grows
larger, the parasite cohort gets older. When we plot parasite cohorts by
age, time is going backwards on the x-axis.</p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<p>Now, we can imagine what <code>zda</code> would look like for several
different host cohorts at age three, but who were born at different
times. In effect, we are taking a snapshot of the cohorts at the same
age, but at different times.</p>
<p>The curves are different because the hosts were born at different
months, and they thus experienced different levels of exposure over the
first two years of life. Here the annual FoI is 5 infections, per
person, per year (<span class="math inline">\(\bar h =
5/365\)</span>):</p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="multiplicity-of-infection-moi">Multiplicity of Infection (MoI)<a class="anchor" aria-label="anchor" href="#multiplicity-of-infection-moi"></a>
</h2>
<p>We define a random variable <span class="math inline">\(M\)</span>
describing the multiplicity of infection (MoI). The distribution of the
MoI is Poisson (see the <a href="MoI.html">MoI</a> vignette).</p>
<p><span class="math display">\[M_\tau(a) \sim f_M(\zeta; a, \tau) =
\mbox{Pois}(m_\tau(a))\]</span></p>
<p>Since <span class="math inline">\(z_\tau(\alpha, a)\)</span>
describes the density of <em>all</em> infections of age <span class="math inline">\(\alpha\)</span> in a cohort of age <span class="math inline">\(a\)</span>, the density of all infections must be
the MoI. Since <span class="math inline">\(0 \leq \alpha &lt;
a\)</span>, it must be true that:</p>
<p><span class="math display">\[\begin{equation}
\tag{2}
m_\tau(a) = \int_0^a z_\tau(\alpha, a) d \alpha
\end{equation}\]</span></p>
<p>The function that computes <span class="math inline">\(m_\tau(a)\)</span> is called
<code>meanMoI.</code></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mm</span> <span class="op">=</span> <span class="fu"><a href="../reference/meanMoI.html">meanMoI</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="va">foiP3</span>, hhat<span class="op">=</span><span class="fl">5</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span></span></code></pre></div>
<p>Here, we plot the average MoI in the host cohort as it ages:</p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="age-of-infection-aoi">Age of Infection (AoI)<a class="anchor" aria-label="anchor" href="#age-of-infection-aoi"></a>
</h2>
<p>We define a random variable <span class="math inline">\(A_\tau(a)\)</span> that describes the age of
infection (AoI), which is given by the formula</p>
<p><span class="math display">\[
A_\tau(a) \sim f_A(\alpha; a, \tau) = \frac{z_\tau(\alpha,a)}{m_\tau(a)}
\]</span></p>
<div class="section level3">
<h3 id="the-density-function-daoi">The Density Function, <code>dAoI</code><a class="anchor" aria-label="anchor" href="#the-density-function-daoi"></a>
</h3>
<p>We can compute <span class="math inline">\(A_\tau(a)\)</span> using
the density function <code>dAoI</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f_A</span> <span class="op">=</span> <span class="fu"><a href="../reference/dAoI.html">dAoI</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">a3years</span><span class="op">)</span>, <span class="va">foiP3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<p>Now, as we plot the distribution of the AoI in cohorts at age two,
born at different months (as we did above), we notice that the
distributions have changed shapes:</p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="the-distribution-function-paoi">The Distribution Function, <code>pAoI</code><a class="anchor" aria-label="anchor" href="#the-distribution-function-paoi"></a>
</h3>
<p>The distribution function for <span class="math inline">\(A_\tau(a)\)</span> is:</p>
<p><span class="math display">\[
F_A(a) \sim \int_0^\alpha f_A(\alpha; a, \tau) d\alpha
\]</span></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">F_A</span> <span class="op">=</span> <span class="fu"><a href="../reference/pAoI.html">pAoI</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">a3years</span><span class="op">)</span>, <span class="va">foiP3</span><span class="op">)</span></span></code></pre></div>
<p>If our functions work correctly, then we should get approximately the
same answer from computing the cumulative sum of <code>dAoI.</code></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">F_A_alt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">f_A</span><span class="op">)</span></span></code></pre></div>
<p>We shouldn’t expect the answers to be exactly the same, but they
should be close, with the <code>pAoI</code> in black.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="va">F_A</span>, type <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Parasite Cohort Age"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="cn">F</span><span class="op">[</span><span class="va">X</span><span class="op">]</span><span class="op">(</span><span class="va">alpha</span>, <span class="va">a</span>, <span class="va">tau</span><span class="op">)</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="va">F_A_alt</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty <span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-14-1.png" width="576"></p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-15-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="random-numbers-raoi">Random Numbers, <code>rAoI</code><a class="anchor" aria-label="anchor" href="#random-numbers-raoi"></a>
</h3>
<p>The function <code>rAoI</code> uses <code>pAoI</code> to generate
random numbers from <span class="math inline">\(F_A(\alpha)\)</span></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rhx</span> <span class="op">=</span> <span class="fu"><a href="../reference/rAoI.html">rAoI</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">3</span><span class="op">*</span><span class="fl">365</span>, <span class="va">foiP3</span><span class="op">)</span></span></code></pre></div>
<p>A simple visual check computes the empirical CDF for the random
variates against <span class="math inline">\(F_A(\alpha)\)</span>
computed using <code>pAoI</code></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">rhx</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1095</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.2</span>, main <span class="op">=</span> <span class="st">""</span>, </span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Parasite Age (in Days)"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">F</span><span class="op">[</span><span class="va">A</span><span class="op">]</span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"ecdf"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="va">F_A</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-17-1.png" width="576"></p>
<p>We can also plot the distribution functions.</p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-18-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="aoi-moments">AoI Moments<a class="anchor" aria-label="anchor" href="#aoi-moments"></a>
</h3>
<p>Let <span class="math inline">\(x\)</span> denote the first moment of
of <span class="math inline">\(A_\tau(a)\)</span>: <span class="math display">\[x_\tau(a) = \left&lt; A_\tau(a) \right&gt; =
\int_0^\infty \alpha \frac{z_\tau(\alpha, a)} {m_\tau(a)}\]</span></p>
<p>Similarly, we let <span class="math inline">\(x_\tau(a)[n]\)</span>
denote the higher order moments of <span class="math inline">\(A_\tau(a)\)</span>: <span class="math display">\[x_{[n]}(a, \tau) = \int_0^\infty \alpha^n
\frac{z_\tau(\alpha, a)} {m_\tau(a)}\]</span></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">moment1</span> <span class="op">=</span> <span class="fu"><a href="../reference/momentAoI.html">momentAoI</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="va">foiP3</span><span class="op">)</span></span>
<span><span class="va">moment2</span> <span class="op">=</span> <span class="fu"><a href="../reference/momentAoI.html">momentAoI</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="va">foiP3</span>, n<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">moment3</span> <span class="op">=</span> <span class="fu"><a href="../reference/momentAoI.html">momentAoI</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="va">foiP3</span>, n<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>The first three moments of the AoY plotted over time. In the top
plot, we’ve also plotted the <span class="math inline">\(n^{th}\)</span>
root of the <span class="math inline">\(n^{th}\)</span> moment.</p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-20-1.png" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="age-of-the-youngest-infection-aoy">Age of the Youngest Infection (AoY)<a class="anchor" aria-label="anchor" href="#age-of-the-youngest-infection-aoy"></a>
</h2>
<p>We have derived a random variable <span class="math inline">\(Y_\tau(a)\)</span> describing the age of the
youngest infection (AoY). The density function for the AoY is:</p>
<p><span class="math display">\[Y_\tau(a) \sim f_Y(\alpha; a, \tau) =
f_A(\alpha, a,\tau) e^{-m_\tau(a) F_A(\alpha, a,\tau)}
\frac{m_\tau(a)}{p_\tau(a)}\]</span> The distribution function is:</p>
<p><span class="math display">\[F_Y(a) \sim
\frac{1-e^{-m_\tau(a)F_A(\alpha, a,\tau)}}{1-e^{-m_\tau(a)}} =
\frac{1-e^{-m_\tau(a)F_A(\alpha, a,\tau)}}{p_\tau(a)}
\]</span></p>
<p>The derivations are found in a Suppplement to Henry JM, <em>et
al.</em> (2024).</p>
<p>The mean AoY is:</p>
<p><span class="math display">\[
\left&lt; Y_\tau(a) \right&gt; = \int_0^a \alpha \; f_Y(\alpha, a, \tau)
\; d\alpha \]</span></p>
<p>And the higher order moments for the AoY are:</p>
<p><span class="math display">\[\left&lt; Y_\tau(a)^n \right&gt; =
\int_0^n \alpha^n \; f_y(\alpha, a, \tau) \; d\alpha \]</span></p>
<div class="section level3">
<h3 id="aoy-density-daoy">AoY Density, <code>dAoY</code><a class="anchor" aria-label="anchor" href="#aoy-density-daoy"></a>
</h3>
<p>The density function is computed with the function
<code>dAoY.</code></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f_Y</span> <span class="op">=</span> <span class="fu"><a href="../reference/dAoY.html">dAoY</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="fl">3</span><span class="op">*</span><span class="fl">365</span>, <span class="va">foiP3</span><span class="op">)</span></span></code></pre></div>
<p>We can compare <span class="math inline">\(f_Y(\alpha)\)</span> (in
black) to <span class="math inline">\(f_A(alpha)\)</span> (in grey).</p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-22-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="random-variables-raoy">Random Variables, <code>rAoY</code><a class="anchor" aria-label="anchor" href="#random-variables-raoy"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raoy</span> <span class="op">=</span> <span class="fu"><a href="../reference/rAoY.html">rAoY</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">*</span><span class="fl">365</span>, <span class="va">foiP3</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">raoy</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1095</span>, by <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>, </span>
<span>     right<span class="op">=</span><span class="cn">F</span>, probability<span class="op">=</span><span class="cn">T</span>, main <span class="op">=</span> <span class="st">""</span>, </span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Parasite Age (in Days)"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">grey</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">out</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="va">f_Y</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-24-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="aoy-moments">AoY Moments<a class="anchor" aria-label="anchor" href="#aoy-moments"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aa</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">*</span><span class="fl">365</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span>
<span><span class="va">moment1y</span> <span class="op">=</span> <span class="fu"><a href="../reference/momentAoY.html">momentAoY</a></span><span class="op">(</span><span class="va">aa</span>, <span class="va">foiP3</span><span class="op">)</span></span>
<span><span class="va">moment2y</span> <span class="op">=</span> <span class="fu"><a href="../reference/momentAoY.html">momentAoY</a></span><span class="op">(</span><span class="va">aa</span>, <span class="va">foiP3</span>, n<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">moment3y</span> <span class="op">=</span> <span class="fu"><a href="../reference/momentAoY.html">momentAoY</a></span><span class="op">(</span><span class="va">aa</span>, <span class="va">foiP3</span>, n<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>The first three moments of the AoY plotted over time. In the top
plot, we’ve also plotted the <span class="math inline">\(n^{th}\)</span>
root of the <span class="math inline">\(n^{th}\)</span> moment.</p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-26-1.png" width="576"></p>
<hr>
<p><strong>Next:</strong></p>
<ul>
<li>In the vignette <a href="MoI.html">MoI</a>, we show that the mean
MoI computed using the formula in Eq. 2 gives the same answer as other
approaches.</li>
</ul>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Henry JM, Carter AR, Wu SL, Smith DL (in preparation). A
Probabilistic Synthesis of Malaria Epidemiology: Exposure, Infection,
Parasite Densities, and Detection.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Nåsell I (1985). Hybrid Models of Tropical Infections,
1st edition. Springer-Verlag. <a href="https://doi.org/10.1007/978-3-662-01609-1" class="external-link uri">https://doi.org/10.1007/978-3-662-01609-1</a><a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by John M. Henry, David L. Smith.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
